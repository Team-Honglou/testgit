{"version":3,"file":"jwt.model.js","sourceRoot":"","sources":["../../../../.ng_build/auth/token/jwt/jwt.model.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,eAAe,EAAE,MAAM,cAAc,CAAC;AAE/C,IAAA;;;IASI,sBAAI,kCAAO;QAHX;;WAEG;;;;QACH;YACI,IAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACpC,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC;gBAAC,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;YAEjE,IAAM,OAAO,GAAG,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YAC1C,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC;gBAAC,MAAM,IAAI,KAAK,CAAC,yBAAyB,CAAC,CAAC;YAEzD,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;SAC9B;;;OAAA;IAED;;;;OAIG;;;;;;IACH,iCAAS;;;;;IAAT,UAAU,aAAyB;QAAzB,8BAAA,EAAA,iBAAyB;QAC/B,IAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC;QAC7B,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;YAAC,MAAM,CAAC,IAAI,CAAC;QAEhD,IAAM,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC;QACzB,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAEhC,EAAE,CAAC,CAAC,IAAI,KAAK,IAAI,CAAC;YAAC,MAAM,CAAC,KAAK,CAAC;QAEhC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,EAAE,GAAG,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,CAAC,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;KAC9E;wBArCL;IAsCC,CAAA;AAnCD,yBAmCC","sourcesContent":["import { ITokenModel } from '../interface';\r\nimport { urlBase64Decode } from './jwt.helper';\r\n\r\nexport class JWTTokenModel implements ITokenModel {\r\n\r\n    [key: string]: any;\r\n\r\n    token: string;\r\n\r\n    /**\r\n     * 获取载荷信息\r\n     */\r\n    get payload(): any {\r\n        const parts = this.token.split('.');\r\n        if (parts.length !== 3) throw new Error('JWT must have 3 parts');\r\n\r\n        const decoded = urlBase64Decode(parts[1]);\r\n        if (!decoded) throw new Error('Cannot decode the token');\r\n\r\n        return JSON.parse(decoded);\r\n    }\r\n\r\n    /**\r\n     * 检查Token是否过期，`payload` 必须包含 `exp` 时有效\r\n     *\r\n     * @param {number} [offsetSeconds=0] 偏移量\r\n     */\r\n    isExpired(offsetSeconds: number = 0): boolean {\r\n        const decoded = this.payload;\r\n        if (!decoded.hasOwnProperty('exp')) return null;\r\n\r\n        const date = new Date(0);\r\n        date.setUTCSeconds(decoded.exp);\r\n\r\n        if (date === null) return false;\r\n\r\n        return !(date.valueOf() > (new Date().valueOf() + (offsetSeconds * 1000)));\r\n    }\r\n}\r\n"]}