{"version":3,"file":"water-wave.component.js","sourceRoot":"","sources":["../../../../.ng_build/abc/charts/water-wave/water-wave.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, HostBinding, ViewChild, ElementRef, OnDestroy, OnChanges, SimpleChanges, NgZone, TemplateRef, OnInit, HostListener, ViewEncapsulation, Renderer2, SimpleChange, ChangeDetectionStrategy, ChangeDetectorRef } from '@angular/core';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { debounceTime } from 'rxjs/operators';\r\nimport { FromEventObservable } from 'rxjs/observable/FromEventObservable';\r\nimport { coerceNumberProperty } from '@angular/cdk/coercion';\r\n\r\n@Component({\r\n    selector: 'water-wave',\r\n    template: `\r\n    <div [ngStyle]=\"{'height.px': height, 'width.px': height, 'overflow': 'hidden'}\">\r\n        <canvas #container class=\"canvas-wrap\" width=\"{{height*2}}\" height=\"{{height*2}}\"></canvas>\r\n    </div>\r\n    <div class=\"text\" [ngStyle]=\"{'width.px': height}\">\r\n        <ng-container *ngIf=\"_title; else _titleTpl\"><span>{{_title}}</span></ng-container>\r\n        <h4>{{percent}}%</h4>\r\n    </div>`,\r\n    styleUrls: [ './water-wave.css' ],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class WaterWaveComponent implements OnDestroy, OnChanges, OnInit {\r\n\r\n    // region: fields\r\n\r\n    _title = '';\r\n    _titleTpl: TemplateRef<any>;\r\n    @Input()\r\n    set title(value: string | TemplateRef<any>) {\r\n        if (value instanceof TemplateRef)\r\n            this._titleTpl = value;\r\n        else\r\n            this._title = value;\r\n    }\r\n\r\n    @Input() color = '#1890FF';\r\n\r\n    @Input()\r\n    get height() { return this._height; }\r\n    set height(value: any) {\r\n        this._height = coerceNumberProperty(value);\r\n    }\r\n    private _height = 160;\r\n\r\n    @Input()\r\n    get percent() { return this._percent; }\r\n    set percent(value: any) {\r\n        this._percent = coerceNumberProperty(value);\r\n    }\r\n    private _percent: number;\r\n\r\n    // endregion\r\n\r\n    @ViewChild('container') node: ElementRef;\r\n\r\n    initFlag = false;\r\n    timer: any;\r\n\r\n    constructor(private el: ElementRef, private renderer: Renderer2, private cd: ChangeDetectorRef) { }\r\n\r\n    renderChart() {\r\n        const data = this.percent / 100;\r\n        if (!data) return;\r\n\r\n        this.node.nativeElement.innerHTML = '';\r\n        const self = this;\r\n\r\n        const canvas = this.node.nativeElement as HTMLCanvasElement;\r\n        const ctx = canvas.getContext('2d');\r\n\r\n        const canvasWidth = canvas.width;\r\n        const canvasHeight = canvas.height;\r\n        const radius = canvasWidth / 2;\r\n        const lineWidth = 2;\r\n        const cR = radius - (lineWidth);\r\n\r\n        ctx.beginPath();\r\n        ctx.lineWidth = lineWidth * 2;\r\n\r\n        const axisLength = canvasWidth - (lineWidth);\r\n        const unit = axisLength / 8;\r\n        const range = 0.2; // 振幅\r\n        let currRange = range;\r\n        const xOffset = lineWidth;\r\n        let sp = 0; // 周期偏移量\r\n        let currData = 0;\r\n        const waveupsp = 0.005; // 水波上涨速度\r\n\r\n        let arcStack = [];\r\n        const bR = radius - (lineWidth);\r\n        const circleOffset = -(Math.PI / 2);\r\n        let circleLock = true;\r\n\r\n        for (let i = circleOffset; i < circleOffset + (2 * Math.PI); i += 1 / (8 * Math.PI)) {\r\n            arcStack.push([\r\n            radius + (bR * Math.cos(i)),\r\n            radius + (bR * Math.sin(i)),\r\n            ]);\r\n        }\r\n\r\n        const cStartPoint = arcStack.shift();\r\n        ctx.strokeStyle = this.color;\r\n        ctx.moveTo(cStartPoint[0], cStartPoint[1]);\r\n\r\n        function drawSin() {\r\n            ctx.beginPath();\r\n            ctx.save();\r\n\r\n            const sinStack = [];\r\n            for (let i = xOffset; i <= xOffset + axisLength; i += 20 / axisLength) {\r\n            const x = sp + ((xOffset + i) / unit);\r\n            const y = Math.sin(x) * currRange;\r\n            const dx = i;\r\n            const dy = ((2 * cR * (1 - currData)) + (radius - cR)) - (unit * y);\r\n\r\n            ctx.lineTo(dx, dy);\r\n            sinStack.push([dx, dy]);\r\n            }\r\n\r\n            const startPoint = sinStack.shift();\r\n\r\n            ctx.lineTo(xOffset + axisLength, canvasHeight);\r\n            ctx.lineTo(xOffset, canvasHeight);\r\n            ctx.lineTo(startPoint[0], startPoint[1]);\r\n\r\n            const gradient = ctx.createLinearGradient(0, 0, 0, canvasHeight);\r\n            gradient.addColorStop(0, '#ffffff');\r\n            gradient.addColorStop(1, '#1890FF');\r\n            ctx.fillStyle = gradient;\r\n            ctx.fill();\r\n            ctx.restore();\r\n        }\r\n\r\n        function render() {\r\n            ctx.clearRect(0, 0, canvasWidth, canvasHeight);\r\n            if (circleLock) {\r\n            if (arcStack.length) {\r\n                const temp = arcStack.shift();\r\n                ctx.lineTo(temp[0], temp[1]);\r\n                ctx.stroke();\r\n            } else {\r\n                circleLock = false;\r\n                ctx.lineTo(cStartPoint[0], cStartPoint[1]);\r\n                ctx.stroke();\r\n                arcStack = null;\r\n\r\n                ctx.globalCompositeOperation = 'destination-over';\r\n                ctx.beginPath();\r\n                ctx.lineWidth = lineWidth;\r\n                ctx.arc(radius, radius, bR, 0, 2 * Math.PI, true);\r\n\r\n                ctx.beginPath();\r\n                ctx.save();\r\n                ctx.arc(radius, radius, radius - (3 * lineWidth), 0, 2 * Math.PI, true);\r\n\r\n                ctx.restore();\r\n                ctx.clip();\r\n                ctx.fillStyle = '#1890FF';\r\n            }\r\n            } else {\r\n            if (data >= 0.85) {\r\n                if (currRange > range / 4) {\r\n                const t = range * 0.01;\r\n                currRange -= t;\r\n                }\r\n            } else if (data <= 0.1) {\r\n                if (currRange < range * 1.5) {\r\n                const t = range * 0.01;\r\n                currRange += t;\r\n                }\r\n            } else {\r\n                if (currRange <= range) {\r\n                const t = range * 0.01;\r\n                currRange += t;\r\n                }\r\n                if (currRange >= range) {\r\n                const t = range * 0.01;\r\n                currRange -= t;\r\n                }\r\n            }\r\n            if ((data - currData) > 0) {\r\n                currData += waveupsp;\r\n            }\r\n            if ((data - currData) < 0) {\r\n                currData -= waveupsp;\r\n            }\r\n\r\n            sp += 0.07;\r\n            drawSin();\r\n            }\r\n            self.timer = requestAnimationFrame(render);\r\n        }\r\n\r\n        render();\r\n    }\r\n\r\n    uninstall() {\r\n    }\r\n\r\n    private updateRadio(radio: number) {\r\n        this.renderer.setStyle(this.el.nativeElement, 'transform', `scale(${radio})`);\r\n    }\r\n\r\n    ngOnInit(): void {\r\n        this.initFlag = true;\r\n        this.updateRadio(1);\r\n        setTimeout(() => this.resize(), 100);\r\n        this.installResizeEvent();\r\n    }\r\n\r\n    ngOnChanges(changes: { [P in keyof this]?: SimpleChange } & SimpleChanges): void {\r\n        if (this.initFlag)\r\n            this.renderChart();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        if (this.timer) cancelAnimationFrame(this.timer);\r\n        this.uninstallResizeEvent();\r\n        this.uninstall();\r\n    }\r\n\r\n    // region: resize\r\n\r\n    private autoHideXLabels = false;\r\n    private scroll$: Subscription = null;\r\n    private installResizeEvent() {\r\n        if (this.scroll$) return;\r\n\r\n        this.scroll$ = <any>FromEventObservable.create(window, 'resize')\r\n                            .pipe(debounceTime(500))\r\n                            .subscribe(() => this.resize());\r\n    }\r\n\r\n    private uninstallResizeEvent() {\r\n        if (this.scroll$) this.scroll$.unsubscribe();\r\n    }\r\n\r\n    resize() {\r\n        const { offsetWidth } = this.el.nativeElement.parentNode;\r\n        this.updateRadio(offsetWidth < this.height ? offsetWidth / this.height : 1);\r\n        this.renderChart();\r\n    }\r\n\r\n    // endregion\r\n}\r\n"]}