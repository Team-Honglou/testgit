{"version":3,"file":"full-content.component.js","sourceRoot":"","sources":["../../../.ng_build/abc/full-content/full-content.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, ElementRef, Renderer2, ChangeDetectionStrategy, ChangeDetectorRef, Input, Output, EventEmitter, OnChanges, SimpleChanges, SimpleChange, OnInit, Inject, HostBinding, OnDestroy, AfterViewInit } from '@angular/core';\r\nimport { coerceBooleanProperty, coerceNumberProperty } from '@angular/cdk/coercion';\r\nimport { DOCUMENT } from '@angular/platform-browser';\r\nimport { Subscription } from 'rxjs/Subscription';\r\nimport { FromEventObservable } from 'rxjs/observable/FromEventObservable';\r\nimport { debounceTime, filter, distinct } from 'rxjs/operators';\r\nimport { FullContentService } from './full-content.service';\r\nimport { Router, ActivationStart, ActivationEnd } from '@angular/router';\r\n\r\nconst cls = `full-content`;\r\nconst fsCls = `full-content-fs`;\r\nconst hideTitleCls = `full-content-ht`;\r\n\r\n@Component({\r\n    selector: 'full-content',\r\n    template: `<ng-content></ng-content>`,\r\n    styleUrls: [ './full-content.css' ],\r\n    changeDetection: ChangeDetectionStrategy.OnPush\r\n})\r\nexport class FullContentComponent implements OnInit, AfterViewInit, OnChanges, OnDestroy {\r\n\r\n    private bodyEl: HTMLBodyElement;\r\n    private inited = false;\r\n    private srv$: Subscription;\r\n    private route$: Subscription;\r\n\r\n    @HostBinding('attr.id')\r\n    id = `_full-content-${Math.random().toString(36).substring(2)}`;\r\n\r\n    @HostBinding('style.height.px')\r\n    _height = 0;\r\n\r\n    // region: fields\r\n\r\n    @Input()\r\n    get fullscreen() { return this._fullscreen; }\r\n    set fullscreen(value: any) {\r\n        this._fullscreen = coerceBooleanProperty(value);\r\n    }\r\n    private _fullscreen;\r\n\r\n    @Input()\r\n    get hideTitle() { return this._hideTitle; }\r\n    set hideTitle(value: any) {\r\n        this._hideTitle = coerceBooleanProperty(value);\r\n    }\r\n    private _hideTitle = true;\r\n\r\n    @Input()\r\n    get padding() { return this._padding; }\r\n    set padding(value: any) {\r\n        this._padding = coerceNumberProperty(value);\r\n    }\r\n    private _padding = 24;\r\n\r\n    @Output() fullscreenChange: EventEmitter<boolean> = new EventEmitter<boolean>();\r\n\r\n    // endregion\r\n\r\n    constructor(\r\n        private el: ElementRef,\r\n        private render: Renderer2,\r\n        private router: Router,\r\n        private cd: ChangeDetectorRef,\r\n        private srv: FullContentService,\r\n        @Inject(DOCUMENT) private doc: Document\r\n    ) {}\r\n\r\n    ngOnInit(): void {\r\n        this.inited = true;\r\n        this.bodyEl = this.doc.querySelector('body');\r\n        this.bodyEl.classList.add(cls);\r\n        this.update();\r\n        this.installResizeEvent();\r\n        setTimeout(() => this.updateHeight(), 100);\r\n        this.srv$ = <any>this.srv.change.subscribe(res => {\r\n            if (res) this.toggle();\r\n        });\r\n        this.route$ = <any>this.router.events.pipe(\r\n            filter((e: any) => e instanceof ActivationStart || e instanceof ActivationEnd),\r\n            debounceTime(100)\r\n        ).subscribe(e => {\r\n            if (!!document.querySelector('#' + this.id)) {\r\n                this.bodyEl.classList.add(cls);\r\n                this.updateFsCls();\r\n            } else {\r\n                this.bodyEl.classList.remove(cls, fsCls, hideTitleCls);\r\n            }\r\n        });\r\n    }\r\n\r\n    ngAfterViewInit(): void {\r\n    }\r\n\r\n    private updateFsCls() {\r\n        if (this.fullscreen) {\r\n            this.bodyEl.classList.add(fsCls, this.hideTitle ? hideTitleCls : '');\r\n        } else {\r\n            this.bodyEl.classList.remove(fsCls, this.hideTitle ? hideTitleCls : '');\r\n        }\r\n    }\r\n\r\n    private update() {\r\n        this.updateFsCls();\r\n        this.fullscreenChange.emit(this.fullscreen);\r\n    }\r\n\r\n    private updateHeight() {\r\n        this._height = this.bodyEl.getBoundingClientRect().height - (this.el.nativeElement as HTMLElement).getBoundingClientRect().top - this.padding;\r\n        this.cd.detectChanges();\r\n    }\r\n\r\n    toggle() {\r\n        this.fullscreen = !this.fullscreen;\r\n        this.update();\r\n        this.updateHeight();\r\n    }\r\n\r\n    ngOnChanges(changes: { [P in keyof this]?: SimpleChange } & SimpleChanges): void {\r\n        if (this.inited) this.update();\r\n    }\r\n\r\n    ngOnDestroy(): void {\r\n        this.bodyEl.classList.remove(cls, fsCls, hideTitleCls);\r\n        this.uninstallResizeEvent();\r\n        if (this.srv$) this.srv$.unsubscribe();\r\n        if (this.route$) this.route$.unsubscribe();\r\n    }\r\n\r\n    // region: resize\r\n\r\n    private scroll$: Subscription = null;\r\n    private installResizeEvent() {\r\n        this.scroll$ = <any>FromEventObservable.create(window, 'resize')\r\n                            .pipe(debounceTime(200))\r\n                            .subscribe(() => this.updateHeight());\r\n    }\r\n\r\n    private uninstallResizeEvent() {\r\n        if (this.scroll$) this.scroll$.unsubscribe();\r\n    }\r\n\r\n    // endregion\r\n}\r\n"]}